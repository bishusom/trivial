function initPuzzle(){let a=document.getElementById("sequence-display"),r=document.getElementById("sequence-options"),c=document.getElementById("sequence-feedback"),l=document.getElementById("hint-text");var e=document.getElementById("sequence-hint"),t=document.getElementById("sequence-next"),n=document.getElementById("sequence-new");let o=document.getElementById("sequence-level"),s=document.getElementById("sequence-score"),d=[],h=0,u=1,i=0,m=0,M=null;function f(){M&&(clearTimeout(M),M=null),u=1,i=0,m=0,C(),y(),"undefined"!=typeof gtag&&gtag("event","sequence_started",{event_category:"number_sequence",event_label:1,value:void 0})}function p(){var t=Math.floor(10*Math.random())+1,n=Math.floor(6*Math.random())+2,o=Math.floor(3*Math.random())+4,a=(console.log("length",o),[]);for(let e=0;e<o;e++)a.push(t+e*n);return console.log("sequence",a),{sequence:a.slice(0,-1),answer:a[a.length-1],description:`Arithmetic sequence: add ${n} each time`}}function g(){var t=Math.floor(5*Math.random())+1,n=Math.floor(3*Math.random())+2,o=Math.floor(3*Math.random())+4,a=[];for(let e=0;e<o;e++)a.push(t*Math.pow(n,e));return{sequence:a.slice(0,-1),answer:a[a.length-1],description:`Geometric sequence: multiply by ${n} each time`}}function q(){var t=Math.floor(5*Math.random())+1,n=Math.floor(3*Math.random())+4,o=[];for(let e=0;e<n;e++)o.push(Math.pow(t+e,2));return{sequence:o.slice(0,-1),answer:o[o.length-1],description:"Square numbers: nÂ² where n starts at "+t}}function v(){var e=Math.floor(4*Math.random()),t=Math.floor(3*Math.random())+4,e=[2,3,5,7,11,13,17,19,23,29].slice(e,e+t);return{sequence:e.slice(0,-1),answer:e[e.length-1],description:"Prime number sequence"}}function E(){var e=Math.floor(5*Math.random())+1,t=Math.floor(5*Math.random())+1,n=Math.floor(3*Math.random())+5,o=[e,t];for(let e=2;e<n;e++)o.push(o[e-1]+o[e-2]);return{sequence:o.slice(0,-1),answer:o[o.length-1],description:"Fibonacci-like sequence: each number is the sum of the two preceding ones"}}function b(){var e=[q,v,E];return e[Math.floor(Math.random()*e.length)]()}function y(){a.innerHTML="",r.innerHTML="",c.textContent="",l.textContent="";let e;var{sequence:t,answer:n,description:o}=[p,g,q,v,E,b][e=u<=2?Math.floor(2*Math.random()):u<=4?Math.random()<.7?Math.floor(2*Math.random()):2+Math.floor(2*Math.random()):u<=6?(t=Math.random())<.5?2+Math.floor(2*Math.random()):t<.8?Math.floor(2*Math.random()):4+Math.floor(2*Math.random()):(t=Math.random())<.6?4+Math.floor(2*Math.random()):t<.9?2+Math.floor(2*Math.random()):Math.floor(2*Math.random())](),t=(d=t,h=n,t.forEach((e,t)=>{var n=document.createElement("span");n.className="sequence-number",n.textContent=e,a.appendChild(n)}),document.createElement("span"));t.className="sequence-number missing",t.textContent="?",a.appendChild(t),(t=>{console.log("correctAnswer",t);for(var n=[t];n.length<4;){let e;switch(Math.floor(3*Math.random())+1){case 1:e=t+Math.floor(5*Math.random())+1;break;case 2:e=t-Math.floor(5*Math.random())+1;break;case 3:e=t*Math.floor(2*Math.random())+1}0<e&&!n.includes(e)&&n.push(e)}return n.sort(()=>Math.random()-.5)})(n).forEach((e,t)=>{var n=document.createElement("button");n.className="btn",n.textContent=e,n.addEventListener("click",()=>{var t;t=e,parseInt(t)===h?(c.textContent="Correct! Well done!",c.className="sequence-feedback correct",i+=10*u,3<=++m&&(u++,m=0),C(),document.querySelectorAll("#sequence-options button").forEach(e=>{e.disabled=!0,parseInt(e.textContent)===h&&e.classList.add("correct")}),M=setTimeout(()=>{y(),M=null},2500)):(c.textContent="Incorrect. Try again!",c.className="sequence-feedback wrong",document.querySelectorAll("#sequence-options button").forEach(e=>{e.textContent===t&&e.classList.add("wrong")}))}),r.appendChild(n)}),l.dataset.description=o}function C(){o.textContent="Level: "+u,s.textContent="Score: "+i}f(),e.addEventListener("click",function(){l.textContent=l.dataset.description}),t.addEventListener("click",y),t.addEventListener("click",()=>{M&&(clearTimeout(M),M=null),y()}),n.addEventListener("click",f)}export{initPuzzle};
