let categoryGroupClickHandlers=[];document.addEventListener("DOMContentLoaded",()=>{var e=()=>{(i=new Date).getHours(),a=i.getDay(),o=i.getDate(),t=i.getMonth(),n=i.getFullYear(),l=new Date(n,t+1,0).getDate(),(r=new Date(i)).setHours(24,0,0,0),r=Math.floor((r-i)/36e5),(e=new Date(i)).setDate(e.getDate()+(7-a)),e.setHours(0,0,0,0),a=Math.ceil((e-i)/864e5),new Date(n,t+1,1);var e,t,a,o,i={daily:r,weekly:a,monthly:e=l-o+1},n=document.querySelector('[data-category="Daily"]'),r=(n&&(t=n.querySelector("span"))&&(t.innerHTML=`Daily Quiz (Resets in <b>${i.daily} hrs</b>)`),document.querySelector('[data-category="Weekly"]')),l=(r&&(a=r.querySelector("span"))&&(a.innerHTML=`Weekly Quiz (Expires in <b>${i.weekly} days</b>)`),document.querySelector('[data-category="Monthly"]'));l&&(o=l.querySelector("span"))&&(o.innerHTML=`Monthly Quiz (New Quiz in <b>${i.monthly} days</b>)`)};e(),setInterval(e,36e5);let o=document.querySelector(".setup-screen"),h=document.getElementById("dynamic-content"),r=document.querySelector(".hamburger"),l=document.querySelector(".nav-menu"),i=document.querySelector(".scroll-indicator"),n=document.querySelector(".scroll-arrow"),s=null,w=window.location.pathname,y=!1,t=(r&&l&&r.addEventListener("click",()=>{var e="true"===r.getAttribute("aria-expanded");r.setAttribute("aria-expanded",!e),l.classList.toggle("active"),r.querySelector(".material-icons").textContent=e?"menu":"close"}),document.querySelectorAll(".nav-menu a").forEach(e=>{e.addEventListener("click",()=>{l&&r&&(l.classList.remove("active"),r.setAttribute("aria-expanded","false"),r.querySelector(".material-icons").textContent="menu")})}),(window.handleRouting=u)(w),document.querySelectorAll(".dropdown-toggle").forEach(a=>{a.addEventListener("click",e=>{let t=e.target.closest(".dropdown").querySelector(".dropdown-content");a.getAttribute("aria-expanded");document.querySelectorAll(".dropdown-content").forEach(e=>{e!==t&&(e.style.display="none",e.closest(".dropdown").querySelector(".dropdown-toggle").setAttribute("aria-expanded","false"))}),s="block"===t.style.display?(t.style.display="none",a.setAttribute("aria-expanded","false"),null):(t.style.display="block",a.setAttribute("aria-expanded","true"),t),window.innerWidth<=768&&e.preventDefault()})}),document.addEventListener("click",t=>{!t.target.closest(".dropdown")&&s&&(s.style.display="none",s.closest(".dropdown").querySelector(".dropdown-toggle").setAttribute("aria-expanded","false"),s=null),!t.target.closest(".main-nav")&&l?.classList.contains("active")&&(l.classList.remove("active"),r)&&(r.setAttribute("aria-expanded","false"),r.querySelector(".material-icons").textContent="menu");var a=t.target.closest("a[href]");if(a&&!(a.hostname!==window.location.hostname||a.target||a.href.includes(".pdf")||a.href.includes(".jpg")||a.href.includes(".png"))){var e=a.classList.contains("dropdown-toggle");if(!(e&&768<window.innerWidth)){t.preventDefault();e=new URL(a.href).pathname,t=(s&&(s.style.display="none",s.closest(".dropdown").querySelector(".dropdown-toggle").setAttribute("aria-expanded","false"),s=null),l&&(l.classList.remove("active"),r)&&(r.setAttribute("aria-expanded","false"),r.querySelector(".material-icons").textContent="menu"),document.querySelector(".game-screen"));if(t&&t.classList.contains("active")){a=e;if((t=document.querySelector(".summary-screen"))&&t.classList.contains("active"))window.history.pushState({path:a},"",a),u(a);else{var o,i,n,t=document.querySelector(".game-screen");if(t&&t.classList.contains("active")){let e=document.getElementById("nav-warning-modal");e&&(e.classList.remove("hidden"),window.pendingNavigation=a,t=document.getElementById("continue-game"),o=document.getElementById("end-game"),i=t.cloneNode(!0),n=o.cloneNode(!0),t.parentNode.replaceChild(i,t),o.parentNode.replaceChild(n,o),i.addEventListener("click",()=>{e.classList.add("hidden"),window.pendingNavigation=null}),n.addEventListener("click",()=>{e.classList.add("hidden"),"function"==typeof window.endGame&&(window.endGame(),localStorage.removeItem("triviaMasterGameState")),window.pendingNavigation&&(window.history.pushState({path:window.pendingNavigation},"",window.pendingNavigation),u(window.pendingNavigation),window.pendingNavigation=null)}))}else window.history.pushState({path:a},"",a),u(a)}}else window.history.pushState({path:e},"",e),u(e)}}}),document.querySelectorAll(".submenu-toggle").forEach(e=>{e.addEventListener("click",e=>{if(!(768<window.innerWidth)){e.preventDefault(),e.stopPropagation();let t=e.target.closest(".submenu");t.classList.contains("active");document.querySelectorAll(".submenu").forEach(e=>{e!==t&&e.classList.remove("active")}),t.classList.toggle("active")}})}),document.querySelectorAll(".dropdown-toggle").forEach(e=>{e.addEventListener("click",function(e){if(window.innerWidth<=768){e.preventDefault();let t=this.closest(".dropdown");e="true"===this.getAttribute("aria-expanded");document.querySelectorAll(".dropdown").forEach(e=>{e!==t&&(e.classList.remove("active"),e.querySelector(".dropdown-toggle").setAttribute("aria-expanded","false"))}),t.classList.toggle("active"),this.setAttribute("aria-expanded",!e)}})}),document.addEventListener("click",e=>{!e.target.closest(".dropdown")&&window.innerWidth<=768&&document.querySelectorAll(".dropdown").forEach(e=>{e.classList.remove("active"),e.querySelector(".dropdown-toggle").setAttribute("aria-expanded","false")})}),document.querySelector(".nav-close")),c=(t&&l&&t.addEventListener("click",()=>{l.classList.remove("active"),r.setAttribute("aria-expanded","false"),r.querySelector(".material-icons").textContent="menu",t.style.display="none",r.style.display="block"}),window.addEventListener("popstate",()=>{y||(y=!0,u(window.location.pathname),setTimeout(()=>{y=!1},100))}),document.querySelectorAll(".category-group"));function a(){categoryGroupClickHandlers.forEach(({group:e,handler:t})=>{e.querySelector(".group-header").removeEventListener("click",t)}),categoryGroupClickHandlers=[];let a=window.innerWidth<=768;c.forEach(e=>{var t=e.querySelector(".group-header");a?(e.classList.remove("active"),t.addEventListener("click",t=()=>{e.classList.toggle("active")}),categoryGroupClickHandlers.push({group:e,handler:t})):e.classList.add("active")})}a();let d;async function u(o){if(o!==w&&!y){y=!0,o="/"===(w=o)?"/home":o.replace(/\/$/,"");let e=Promise.resolve();var i=o.split("/").filter(e=>e),n=0<i.length?"/"+i[0]:"/home";let t="",a=o;"/home"===o?(t="Page View",a="Home",document.title="Triviaah - Play Trivia Games",f("Play fun and challenging trivia games on Triviaah!")):o.includes("/privacy")?(t="Page View",a="Privacy Policy",document.title="Triviaah - Privacy Policy",f("Read the privacy policy for Triviaah to understand how we handle your data.")):o.includes("/contact")?(t="Page View",a="Contact Us",document.title="Triviaah - Contact Us",f("Get in touch with Triviaah for support or inquiries.")):o.startsWith("/trivias")?(t="Trivia",a=i[1]?i[1].replace(/-/g," "):"Trivia Catalog",i[1]&&"catalog"!==i[1]?(v=i[1].replace(/-/g," "),document.title=`Triviaah - ${v} Trivia`,f(`Play ${v} trivia games on Triviaah! Test your knowledge now.`)):(document.title="Triviaah - Trivia Catalog",f("Explore a variety of trivia games on Triviaah, from weekly challenges to general knowledge."))):o.startsWith("/number-puzzle")?(t="Number Puzzle",a=i[1]?i[1].replace(/-/g," "):"Number Puzzle Catalog",i[1]&&"catalog"!==i[1]?(v=i[1].replace(/-/g," "),document.title=`Triviaah - ${v} Number Puzzle`,f(`Solve ${v} number puzzles on Triviaah! Challenge your math skills.`)):(document.title="Triviaah - Number Puzzle Catalog",f("Discover fun number puzzles on Triviaah, including guess, scramble, and sequence games."))):o.startsWith("/word-game")&&(t="Word Game",a=i[1]?i[1].replace(/-/g," "):"Word Game Catalog",i[1]&&"catalog"!==i[1]?(v=i[1].replace(/-/g," "),document.title=`Triviaah - ${v} Word Game`,f(`Play ${v} word games on Triviaah! Test your vocabulary skills.`)):(document.title="Triviaah - Word Game Catalog",f("Enjoy word games on Triviaah, including classic, anagram, and spelling challenges."))),"undefined"!=typeof gtag&&gtag("event","navigate",{event_category:t,event_label:a,path:o}),document.querySelectorAll(".screen").forEach(e=>{e.classList.remove("active")});var r,l,s,c,d,u,m,g,p,v={"/trivias":["daily","weekly","monthly","general-knowledge","literature","arts","animals","science","history","fashion","festivals","geography","movies","tv","music","celebrities","politics","food","sports","business","mythology","philosophy","video-games","board-games","catalog","tbank"],"/number-puzzle":["guess","scramble","sequence","primehunter","numbertower","sodoku","catalog"],"/word-game":["classic","anagram","spelling","boggle","wordsearch","wordladder","wordscircle","catalog"]};try{v[n]&&1===i.length?L():o.includes("/privacy")?await b("/templates/privacy.html",h):o.includes("/contact")?await b("/templates/contact.html",h):"/home"===o?L():o.startsWith("/trivias")?"catalog"===(r=i[1])?(document.body.classList.remove("game-screen-active"),await b("/templates/trivias/catalog.html",h),l=(await import("/scripts/trivias/catalog.min.js")).initTriviaCatalog,l()):v["/trivias"].includes(r)?(await b("/templates/trivias/trivia.html",h),s=(await import("/scripts/trivias/trivia.min.js")).initTriviaGame,s(r.replace(/-/g," "))):L():o.startsWith("/tbank")?(console.log(i),2===i.length?window.location.href="/tbank"+(1<i.length?"/"+i[1]:""):L()):o.startsWith("/blog")?(console.log(i),2===i.length?window.location.href="/blog"+(1<i.length?"/"+i[1]:""):L()):o.startsWith("/number-puzzle")?"catalog"===(c=i[1])?(document.querySelector(".main-nav").classList.remove("hidden"),await b("/templates/number-puzzle/catalog.html",h)):(v["/number-puzzle"].includes(c)?(document.querySelector(".main-nav").classList.add("hidden"),await b(`/templates/number-puzzle/${c}.html`,h),d=(await import(`/scripts/number-puzzle/${c}.min.js`)).initPuzzle,d):L)():o.startsWith("/word-game")?"catalog"===(u=i[1])?(document.querySelector(".main-nav").classList.remove("hidden"),await b("/templates/word-game/catalog.html",h)):(v["/word-game"].includes(u)?(document.querySelector(".main-nav").classList.add("hidden"),await b(`/templates/word-game/${u}.html`,h),m=(await import(`/scripts/word-game/${u}.min.js`)).initWordGame,m):L)():L()}catch(e){console.error("Routing error:",e),g=o.includes("number-puzzle")?"number-puzzle":o.includes("word-game")?"word-game":"content",(p=document.createElement("div")).className="error",p.innerHTML=`
            <h3>Error Loading ${g.replace("-"," ")}</h3>
            <p>Unable to load the game. Please try again later.</p>
            <a href="/home" class="btn primary">Return Home</a>
        `,h.innerHTML=p.outerHTML,h.classList.add("active")}finally{await e,y=!1}}}function f(e){let t=document.querySelector('meta[name="description"]');t||((t=document.createElement("meta")).name="description",document.head.appendChild(t)),t.content=e}async function b(e,t){try{var a=await fetch(e);if(!a.ok)throw new Error(`Failed to load template from ${e}. Status: `+a.status);t.innerHTML=await a.text(),t.classList.add("active")}catch(e){throw console.error("Template load error:",e),t.innerHTML=`
                <div class="error">
                    <h3>Error Loading Content</h3>
                    <p>Unable to load the requested page. Please try again later.</p>
                    <a href="/home" class="btn primary">Return Home</a>
                </div>
            `,t.classList.add("active"),e}}function L(){o&&o.classList.add("active"),h&&h.classList.remove("active");var e=document.querySelector(".game-screen"),e=(e&&e.classList.remove("active"),document.querySelector(".summary-screen")),e=(e&&e.classList.remove("active"),document.querySelector(".main-nav"));e&&e.classList.remove("hidden")}function m(){var e,t,a;i&&n&&(o.classList.contains("active")?(i.style.display="flex",e=document.documentElement.scrollHeight,t=window.innerHeight,a=window.scrollY||document.documentElement.scrollTop,n.textContent=e-10<=a+t?"keyboard_arrow_up":"keyboard_arrow_down"):i.style.display="none")}window.addEventListener("resize",()=>{clearTimeout(d),d=setTimeout(a,100)}),i&&i.addEventListener("click",()=>{var e=document.documentElement.scrollHeight,t=window.innerHeight;e-10<=(window.scrollY||document.documentElement.scrollTop)+t?window.scrollTo({top:0,behavior:"smooth"}):window.scrollTo({top:e-t,behavior:"smooth"})}),window.addEventListener("scroll",m),window.addEventListener("resize",m),m()});
