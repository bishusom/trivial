document.addEventListener("DOMContentLoaded",()=>{let i=document.querySelector(".setup-screen"),L=document.getElementById("dynamic-content"),o=document.querySelector(".hamburger"),l=document.querySelector(".nav-menu"),n=document.querySelector(".scroll-indicator"),r=document.querySelector(".scroll-arrow"),s=null,E=window.location.pathname,S=!1,e=(o&&l&&o.addEventListener("click",()=>{var e="true"===o.getAttribute("aria-expanded");o.setAttribute("aria-expanded",!e),l.classList.toggle("active"),o.querySelector(".material-icons").textContent=e?"menu":"close"}),document.querySelectorAll(".nav-menu a").forEach(e=>{e.addEventListener("click",()=>{l&&o&&(l.classList.remove("active"),o.setAttribute("aria-expanded","false"),o.querySelector(".material-icons").textContent="menu")})}),(window.handleRouting=c)(E),document.querySelectorAll(".dropdown-toggle").forEach(a=>{a.addEventListener("click",e=>{let t=e.target.closest(".dropdown").querySelector(".dropdown-content");a.getAttribute("aria-expanded");document.querySelectorAll(".dropdown-content").forEach(e=>{e!==t&&(e.style.display="none",e.closest(".dropdown").querySelector(".dropdown-toggle").setAttribute("aria-expanded","false"))}),s="block"===t.style.display?(t.style.display="none",a.setAttribute("aria-expanded","false"),null):(t.style.display="block",a.setAttribute("aria-expanded","true"),t),window.innerWidth<=768&&e.preventDefault()})}),document.addEventListener("click",t=>{!t.target.closest(".dropdown")&&s&&(s.style.display="none",s.closest(".dropdown").querySelector(".dropdown-toggle").setAttribute("aria-expanded","false"),s=null),!t.target.closest(".main-nav")&&l?.classList.contains("active")&&(l.classList.remove("active"),o)&&(o.setAttribute("aria-expanded","false"),o.querySelector(".material-icons").textContent="menu");var a=t.target.closest("a[href]");if(a&&!(a.hostname!==window.location.hostname||a.target||a.href.includes(".pdf")||a.href.includes(".jpg")||a.href.includes(".png"))){var i=a.classList.contains("dropdown-toggle");if(!(i&&768<window.innerWidth)){t.preventDefault();var n,r,i=new URL(a.href).pathname,t=(s&&(s.style.display="none",s.closest(".dropdown").querySelector(".dropdown-toggle").setAttribute("aria-expanded","false"),s=null),l&&(l.classList.remove("active"),o)&&(o.setAttribute("aria-expanded","false"),o.querySelector(".material-icons").textContent="menu"),document.querySelector(".game-screen"));if(t&&t.classList.contains("active")){a=i;let e=document.getElementById("nav-warning-modal");e&&(e.classList.remove("hidden"),window.pendingNavigation=a,a=document.getElementById("continue-game"),t=document.getElementById("end-game"),n=a.cloneNode(!0),r=t.cloneNode(!0),a.parentNode.replaceChild(n,a),t.parentNode.replaceChild(r,t),n.addEventListener("click",()=>{e.classList.add("hidden"),window.pendingNavigation=null}),r.addEventListener("click",()=>{e.classList.add("hidden"),"function"==typeof window.endGame&&(window.endGame(),localStorage.removeItem("triviaMasterGameState")),window.pendingNavigation&&(window.history.pushState({path:window.pendingNavigation},"",window.pendingNavigation),c(window.pendingNavigation),window.pendingNavigation=null)}))}else window.history.pushState({path:i},"",i),c(i)}}}),document.querySelectorAll(".submenu-toggle").forEach(e=>{e.addEventListener("click",e=>{if(!(768<window.innerWidth)){e.preventDefault(),e.stopPropagation();let t=e.target.closest(".submenu");t.classList.contains("active");document.querySelectorAll(".submenu").forEach(e=>{e!==t&&e.classList.remove("active")}),t.classList.toggle("active")}})}),document.querySelectorAll(".dropdown-toggle").forEach(e=>{e.addEventListener("click",function(e){if(window.innerWidth<=768){e.preventDefault();let t=this.closest(".dropdown");e="true"===this.getAttribute("aria-expanded");document.querySelectorAll(".dropdown").forEach(e=>{e!==t&&(e.classList.remove("active"),e.querySelector(".dropdown-toggle").setAttribute("aria-expanded","false"))}),t.classList.toggle("active"),this.setAttribute("aria-expanded",!e)}})}),document.addEventListener("click",e=>{!e.target.closest(".dropdown")&&window.innerWidth<=768&&document.querySelectorAll(".dropdown").forEach(e=>{e.classList.remove("active"),e.querySelector(".dropdown-toggle").setAttribute("aria-expanded","false")})}),document.querySelector(".nav-close")),t=(e&&l&&e.addEventListener("click",()=>{l.classList.remove("active"),o.setAttribute("aria-expanded","false"),o.querySelector(".material-icons").textContent="menu",e.style.display="none",o.style.display="block"}),window.addEventListener("popstate",()=>{S||(S=!0,c(window.location.pathname),setTimeout(()=>{S=!1},100))}),document.querySelectorAll(".category-group"));async function c(i){if(i!==E&&!S){S=!0,i="/"===(E=i)?"/home":i.replace(/\/$/,"");let e=Promise.resolve();var n=i.split("/").filter(e=>e),r=0<n.length?"/"+n[0]:"/home";let t="",a=i;"/home"===i?(t="Page View",a="Home",document.title="Triviaah - Play Trivia Games",T("Play fun and challenging trivia games on Triviaah!")):i.includes("/privacy")?(t="Page View",a="Privacy Policy",document.title="Triviaah - Privacy Policy",T("Read the privacy policy for Triviaah to understand how we handle your data.")):i.includes("/contact")?(t="Page View",a="Contact Us",document.title="Triviaah - Contact Us",T("Get in touch with Triviaah for support or inquiries.")):i.startsWith("/trivias")?(t="Trivia",a=n[1]?n[1].replace(/-/g," "):"Trivia Catalog",n[1]&&"catalog"!==n[1]?(b=n[1].replace(/-/g," "),document.title=`Triviaah - ${b} Trivia`,T(`Play ${b} trivia games on Triviaah! Test your knowledge now.`)):(document.title="Triviaah - Trivia Catalog",T("Explore a variety of trivia games on Triviaah, from weekly challenges to general knowledge."))):i.startsWith("/number-puzzle")?(t="Number Puzzle",a=n[1]?n[1].replace(/-/g," "):"Number Puzzle Catalog",n[1]&&"catalog"!==n[1]?(b=n[1].replace(/-/g," "),document.title=`Triviaah - ${b} Number Puzzle`,T(`Solve ${b} number puzzles on Triviaah! Challenge your math skills.`)):(document.title="Triviaah - Number Puzzle Catalog",T("Discover fun number puzzles on Triviaah, including guess, scramble, and sequence games."))):i.startsWith("/word-game")&&(t="Word Game",a=n[1]?n[1].replace(/-/g," "):"Word Game Catalog",n[1]&&"catalog"!==n[1]?(b=n[1].replace(/-/g," "),document.title=`Triviaah - ${b} Word Game`,T(`Play ${b} word games on Triviaah! Test your vocabulary skills.`)):(document.title="Triviaah - Word Game Catalog",T("Enjoy word games on Triviaah, including classic, anagram, and spelling challenges."))),"undefined"!=typeof gtag&&gtag("event","navigate",{event_category:t,event_label:a,path:i}),document.querySelectorAll(".screen").forEach(e=>{e.classList.remove("active")});var o,l,s,c,d,m,u,g,p,v,h,w,y,f,b={"/trivias":["weekly","monthly","general-knowledge","literature","arts","animals","science","history","fashion","festivals","geography","movies","tv","music","celebrities","politics","food","sports","business","mythology","philosophy","video-games","board-games","catalog","tbank"],"/number-puzzle":["guess","scramble","sequence","primehunter","catalog"],"/word-game":["classic","anagram","spelling","wordsearch","catalog"]};try{b[r]&&1===n.length?k():i.includes("/privacy")?await q("/templates/privacy.html",L):i.includes("/contact")?await q("/templates/contact.html",L):"/home"===i?k():i.startsWith("/trivias")?"catalog"===(o=n[1])?(await q("/templates/trivias/catalog.html",L),l=(await import("/scripts/trivias/catalog.min.js")).initTriviaCatalog,l()):"tbank"===o?(2===n.length?(await q("/templates/trivias/tbank.html",L),{initTbankFilters:s,processSocialSharing:c}=await import("/scripts/trivias/tbank.min.js"),s(),c):(d=(await q(`/templates/trivias/tbank/${n[2]}.html`,L),await import("/scripts/trivias/tbank.min.js")).initTBankControls,d))():b["/trivias"].includes(o)?(await q("/templates/trivias/trivia.html",L),m=(await import("/scripts/trivias/trivia.min.js")).initTriviaGame,m(o.replace(/-/g," "))):k():i.startsWith("/blog")?(u=n[1],console.log(n),(2===n.length?(await q(`/templates/blog/${u}.html`,L),g=(await import("/scripts/trivias/tbank.min.js")).processSocialSharing,g):k)()):i.startsWith("/number-puzzle")?"catalog"===(p=n[1])?await q("/templates/number-puzzle/catalog.html",L):(b["/number-puzzle"].includes(p)?(await q(`/templates/number-puzzle/${p}.html`,L),v=(await import(`/scripts/number-puzzle/${p}.js`)).initPuzzle,v):k)():i.startsWith("/word-game")?"catalog"===(h=n[1])?await q("/templates/word-game/catalog.html",L):(b["/word-game"].includes(h)?(await q(`/templates/word-game/${h}.html`,L),w=(await import(`/scripts/word-game/${h}.js`)).initWordGame,w):k)():k()}catch(e){console.error("Routing error:",e),y=i.includes("number-puzzle")?"number-puzzle":i.includes("word-game")?"word-game":"content",(f=document.createElement("div")).className="error",f.innerHTML=`
            <h3>Error Loading ${y.replace("-"," ")}</h3>
            <p>Unable to load the game. Please try again later.</p>
            <a href="/home" class="btn primary">Return Home</a>
        `,L.innerHTML=f.outerHTML,L.classList.add("active")}finally{await e,S=!1}}}function T(e){let t=document.querySelector('meta[name="description"]');t||((t=document.createElement("meta")).name="description",document.head.appendChild(t)),t.content=e}async function q(e,t){try{var a=await fetch(e);if(!a.ok)throw new Error(`Failed to load template from ${e}. Status: `+a.status);t.innerHTML=await a.text(),t.classList.add("active")}catch(e){throw console.error("Template load error:",e),t.innerHTML=`
                <div class="error">
                    <h3>Error Loading Content</h3>
                    <p>Unable to load the requested page. Please try again later.</p>
                    <a href="/home" class="btn primary">Return Home</a>
                </div>
            `,t.classList.add("active"),e}}function k(){i&&i.classList.add("active"),L&&L.classList.remove("active");var e=document.querySelector(".game-screen"),e=(e&&e.classList.remove("active"),document.querySelector(".summary-screen"));e&&e.classList.remove("active")}function a(){var e,t,a;n&&r&&(i.classList.contains("active")?(n.style.display="flex",e=document.documentElement.scrollHeight,t=window.innerHeight,a=window.scrollY||document.documentElement.scrollTop,r.textContent=e-10<=a+t?"keyboard_arrow_up":"keyboard_arrow_down"):n.style.display="none")}window.innerWidth<=768&&t.forEach(e=>{e.querySelector(".group-header").addEventListener("click",()=>{e.classList.toggle("active")})}),window.addEventListener("resize",()=>{let a=window.innerWidth<=768;t.forEach(e=>{var t=e.querySelector(".group-header");a?(t.addEventListener("click",()=>{e.classList.toggle("active")}),e.classList.remove("active")):(t.removeEventListener("click",()=>{}),e.classList.add("active"))})}),n&&n.addEventListener("click",()=>{var e=document.documentElement.scrollHeight,t=window.innerHeight;e-10<=(window.scrollY||document.documentElement.scrollTop)+t?window.scrollTo({top:0,behavior:"smooth"}):window.scrollTo({top:e-t,behavior:"smooth"})}),window.addEventListener("scroll",a),window.addEventListener("resize",a),a()});
