let WINS_REQUIRED_FOR_NEXT_LEVEL=5,GAME_STATE_KEY="word-game-state",SESSION_USED_WORDS_KEY="word-game-session-used-words",wordGameMessages={win:["üéâ Word Wizard! You've mastered this challenge!","üèÜ Vocabulary Virtuoso! Perfect score!","‚ú® Lexicon Legend! Flawless victory!"],nearWin:["üìñ Almost perfect! One more try?","üß† Great memory! Can you get them all next time?","üí° So close! Your word skills are impressive"],default:["üîç Nice effort! Try again to improve","üìö Every game makes you better","üîÑ Practice makes perfect"]},difficultySettings={easy:{maxAttempts:8,maxHints:3,revealLetters:2,scoreMultiplier:1},medium:{maxAttempts:6,maxHints:2,revealLetters:1,scoreMultiplier:1.5},hard:{maxAttempts:4,maxHints:1,revealLetters:0,scoreMultiplier:2}},wordState=JSON.parse(localStorage.getItem(GAME_STATE_KEY))||{targetWord:"",category:"",difficulty:"easy",attemptsLeft:8,maxAttempts:8,guesses:[],hintsUsed:0,maxHints:3,revealedLetters:[],score:0,isDailyChallenge:!1,isPlaying:!1,letterChoices:[],currentLetterIndex:0,guessedLetters:[],usedWords:JSON.parse(localStorage.getItem("word-game-used-words"))||[],sessionUsedWords:JSON.parse(sessionStorage.getItem(SESSION_USED_WORDS_KEY))||[],winsAtCurrentDifficulty:0,lastPlayed:null},wordGameEls={gameContainer:document.getElementById("word-game-container"),wordDisplay:document.getElementById("word-display"),scoreDisplay:document.getElementById("word-score"),startBtn:document.getElementById("start-word-game"),results:document.getElementById("word-results"),hintBtn:document.getElementById("hint-btn"),feedback:document.getElementById("word-feedback"),attemptsDisplay:document.getElementById("word-attempts"),newWordBtn:document.getElementById("new-word")},WORD_CACHE={WORDS:"word-game-words-v1",EXPIRY:864e5},FALLBACK_WORDS=[{word:"apple",category:"Fruit",hint:"A common fruit"},{word:"house",category:"Building",hint:"Where people live"},{word:"computer",category:"Technology",hint:"A device for computing"},{word:"elephant",category:"Animal",hint:"A large mammal with a trunk"},{word:"ocean",category:"Geography",hint:"Vast body of salt water"},{word:"guitar",category:"Music",hint:"Stringed musical instrument"},{word:"mountain",category:"Geography",hint:"Large natural elevation"},{word:"piano",category:"Music",hint:"Keyboard musical instrument"},{word:"telephone",category:"Technology",hint:"Device for communication"},{word:"television",category:"Technology",hint:"Device for viewing programs"},{word:"bicycle",category:"Transport",hint:"Two-wheeled vehicle"},{word:"airplane",category:"Transport",hint:"Flying vehicle"},{word:"restaurant",category:"Place",hint:"Where meals are served"},{word:"library",category:"Place",hint:"Where books are kept"},{word:"hospital",category:"Place",hint:"Where sick people are treated"}];function updateDifficultyDisplay(){var e=document.getElementById("current-difficulty"),t=document.getElementById("progress-display"),r=wordState.difficulty.charAt(0).toUpperCase()+wordState.difficulty.slice(1);e.textContent="Difficulty: "+r,t.textContent=`Progress: ${wordState.winsAtCurrentDifficulty}/`+WINS_REQUIRED_FOR_NEXT_LEVEL,e.style.color="easy"===wordState.difficulty?"#4CAF50":"medium"===wordState.difficulty?"#FFC107":"#F44336"}function saveGameState(){var e={...wordState,isPlaying:!1};localStorage.setItem(GAME_STATE_KEY,JSON.stringify(e)),sessionStorage.setItem(SESSION_USED_WORDS_KEY,JSON.stringify(wordState.sessionUsedWords))}async function fetchWords(){try{var e="word-list-"+wordState.difficulty,r=JSON.parse(localStorage.getItem(WORD_CACHE.WORDS))?.[e];if(r&&Date.now()-r.timestamp<WORD_CACHE.EXPIRY)return r.words;var a=Math.floor(1e3*Math.random()),o=await db.collection("wordLists").where("difficulty","==",wordState.difficulty).where("randomIndex",">=",a).orderBy("randomIndex").limit(100).get();let t=[];return o.forEach(e=>{e=e.data();t.push({word:e.word,category:e.category,hint:e.hint||"No hint available"})}),0<t.length&&localStorage.setItem(WORD_CACHE.WORDS,JSON.stringify({[e]:{words:t,timestamp:Date.now()}})),t.length?t:FALLBACK_WORDS}catch(e){return console.error("Error fetching words:",e),FALLBACK_WORDS}}function selectRandomWord(e){var t;return e&&0!==e.length?0===(t=e.filter(e=>{var t=e.word.length;let r=!1;return(r="easy"===wordState.difficulty?t<=5:"medium"===wordState.difficulty?5<t&&t<=8:8<t)&&!wordState.usedWords.includes(e.word)&&!wordState.sessionUsedWords.includes(e.word)})).length?(wordState.sessionUsedWords=[],sessionStorage.setItem(SESSION_USED_WORDS_KEY,JSON.stringify(wordState.sessionUsedWords)),selectRandomWord(e)):(e=t[Math.floor(Math.random()*t.length)],wordState.usedWords.push(e.word),wordState.sessionUsedWords.push(e.word),50<wordState.usedWords.length&&(wordState.usedWords=wordState.usedWords.slice(-25)),localStorage.setItem("word-game-used-words",JSON.stringify(wordState.usedWords)),sessionStorage.setItem(SESSION_USED_WORDS_KEY,JSON.stringify(wordState.sessionUsedWords)),e):FALLBACK_WORDS[Math.floor(Math.random()*FALLBACK_WORDS.length)]}function generateLetterChoices(e){for(var e=e.split(""),t="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),r=[...e];r.length<10&&0<t.length;){var a=Math.floor(Math.random()*t.length);r.push(t.splice(a,1)[0])}for(let e=r.length-1;0<e;e--){var o=Math.floor(Math.random()*(e+1));[r[e],r[o]]=[r[o],r[e]]}return r}function initializeGame(){var e=difficultySettings[wordState.difficulty],e=(wordState.maxAttempts=e.maxAttempts,wordState.attemptsLeft=e.maxAttempts,wordState.maxHints=e.maxHints,wordState.hintsUsed=0,wordState.score=0,wordState.guesses=[],wordState.revealedLetters=[],wordState.isPlaying=!1,wordState.letterChoices=[],wordState.currentLetterIndex=0,wordState.guessedLetters=[],JSON.parse(localStorage.getItem("word-game-wins"))||{});wordState.winsAtCurrentDifficulty=e[wordState.difficulty]||0,updateDifficultyDisplay(),updateGameUI(),saveGameState()}async function startWordGame(){wordState.isPlaying=!0,localStorage.removeItem(WORD_CACHE.WORDS);var e=selectRandomWord(await fetchWords()),e=(wordState.targetWord=e.word.toUpperCase(),wordState.category=e.category,wordState.hint=e.hint,wordState.letterChoices=generateLetterChoices(wordState.targetWord),difficultySettings[wordState.difficulty]);wordState.revealedLetters=Array(wordState.targetWord.length).fill(!1),wordState.guessedLetters=Array(wordState.targetWord.length).fill("");let t=e.revealLetters;for(;0<t;){var r=Math.floor(Math.random()*wordState.targetWord.length);wordState.revealedLetters[r]||(wordState.revealedLetters[r]=!0,wordState.guessedLetters[r]=wordState.targetWord[r],t--)}wordState.attemptsLeft=e.maxAttempts,wordState.guesses=[],updateGameUI(),saveGameState()}function updateGameUI(){wordGameEls.attemptsDisplay.textContent="Attempts left: "+wordState.attemptsLeft,wordGameEls.scoreDisplay.textContent="Score: "+wordState.score;let t=`
        <div class="word-display-info">${wordState.category} (${wordState.targetWord.length} letters)</div>
        <div class="word-hint">Hint: ${wordState.hint||"No hint available"}</div>
        <div class="word-display-letters">`;for(let e=0;e<wordState.targetWord.length;e++){var r=(wordState.revealedLetters[e]?wordState.targetWord:wordState.guessedLetters)[e];t+=`
            <div class="letter-container">
                ${wordState.revealedLetters[e]||wordState.guessedLetters[e]?`<span class="letter">${r}</span>`:'<span class="empty-letter">_</span>'}
                ${!wordState.revealedLetters[e]&&wordState.guessedLetters[e]?`<button class="remove-letter" data-index="${e}">√ó</button>`:""}
            </div>
        `}t+="</div>",wordGameEls.wordDisplay.innerHTML=t;var e=wordState.letterChoices.map(e=>`
        <button class="letter-choice" 
                data-letter="${e}"
                ${wordState.isPlaying?"":"disabled"}>
            ${e}
        </button>
    `).join("");wordGameEls.results.innerHTML=`
        <div class="letter-choices">${e}</div>
        ${wordState.guesses.map(e=>createGuessRow(e)).join("")}
    `}function createGuessRow(r){let a='<div class="guess-row">';for(let t=0;t<r.length;t++){var o=r[t];let e="letter-box";o===wordState.targetWord[t]?e+=" correct":wordState.targetWord.includes(o)?e+=" present":e+=" absent",a+=`<div class="${e}">${o}</div>`}return a+="</div>"}async function makeGuess(a){if(wordState.isPlaying){var o=wordState.targetWord.includes(a);if(o){let r=!1;for(let t=0;t<wordState.targetWord.length;t++)if(wordState.targetWord[t]===a&&!wordState.revealedLetters[t]&&!wordState.guessedLetters[t]){wordState.guessedLetters[t]=a,r=!0;let e=document.querySelectorAll(".letter-container")[t];e.classList.add("correct-feedback"),setTimeout(()=>{e.classList.remove("correct-feedback")},2e3)}if(r){updateGameUI(),saveGameState();let e=wordState.guessedLetters.every((e,t)=>e||wordState.revealedLetters[t]);if(e){var s=wordState.guessedLetters.join("");if(wordState.attemptsLeft--,s===wordState.targetWord)return wordState.score+=10*difficultySettings[wordState.difficulty].scoreMultiplier,void endWordGame(!0);var d=createGuessRow(s);wordState.guesses.push(s),wordGameEls.results.prepend(d),wordState.guessedLetters=Array(wordState.targetWord.length).fill("").map((e,t)=>wordState.revealedLetters[t]?wordState.targetWord[t]:""),wordState.attemptsLeft<=0?endWordGame(!1):(updateGameUI(),saveGameState())}return}}let r=wordState.guessedLetters.findIndex((e,t)=>!e&&!wordState.revealedLetters[t]);if(-1!==r){wordState.guessedLetters[r]=a,updateGameUI(),saveGameState();s=document.querySelector(`.letter-choice[data-letter="${a}"]`);let e=document.querySelectorAll(".letter-container")[r],t=(o?(e.classList.add("present-feedback"),setTimeout(()=>{e.classList.remove("present-feedback")},2e3)):(e.classList.add("wrong-feedback"),setTimeout(()=>{e.classList.remove("wrong-feedback"),wordState.guessedLetters[r]="",updateGameUI(),saveGameState()},2e3),s.classList.add("disabled-letter")),wordState.guessedLetters.every((e,t)=>e||wordState.revealedLetters[t]));t&&(d=wordState.guessedLetters.join(""),wordState.attemptsLeft--,d===wordState.targetWord?(wordState.score+=10*difficultySettings[wordState.difficulty].scoreMultiplier,endWordGame(!0)):(o=createGuessRow(d),wordState.guesses.push(d),wordGameEls.results.prepend(o),wordState.guessedLetters=Array(wordState.targetWord.length).fill("").map((e,t)=>wordState.revealedLetters[t]?wordState.targetWord[t]:""),wordState.attemptsLeft<=0?endWordGame(!1):(updateGameUI(),saveGameState())))}}}function getHint(){var e;wordState.hintsUsed>=wordState.maxHints||!wordState.isPlaying||0!==(e=wordState.revealedLetters.map((e,t)=>e?-1:t).filter(e=>-1!==e)).length&&(e=e[Math.floor(Math.random()*e.length)],wordState.revealedLetters[e]=!0,wordState.guessedLetters[e]=wordState.targetWord[e],wordState.hintsUsed++,updateGameUI(),saveGameState())}async function endWordGame(e){wordState.isPlaying=!1;let t;var r;e?(t=wordGameMessages.win[Math.floor(Math.random()*wordGameMessages.win.length)],wordState.winsAtCurrentDifficulty++,(r=JSON.parse(localStorage.getItem("word-game-wins"))||{})[wordState.difficulty]=wordState.winsAtCurrentDifficulty,localStorage.setItem("word-game-wins",JSON.stringify(r)),wordState.winsAtCurrentDifficulty>=WINS_REQUIRED_FOR_NEXT_LEVEL?("easy"===wordState.difficulty?(wordState.difficulty="medium",t+=`<br><br>Great job! You've won ${WINS_REQUIRED_FOR_NEXT_LEVEL} games on Easy. Advancing to Medium difficulty!`):"medium"===wordState.difficulty?(wordState.difficulty="hard",t+=`<br><br>Excellent! You've won ${WINS_REQUIRED_FOR_NEXT_LEVEL} games on Medium. Now try Hard difficulty!`):t+="<br><br>Mastered Hard mode! You're a word game champion!",wordState.winsAtCurrentDifficulty=0,r[wordState.difficulty]=0,localStorage.setItem("word-game-wins",JSON.stringify(r))):(r=WINS_REQUIRED_FOR_NEXT_LEVEL-wordState.winsAtCurrentDifficulty,t+=`<br><br>${r} more win${1==r?"":"s"} to advance to the next level!`),setTimeout(()=>{initializeGame(),startWordGame()},2e3)):(t=0<wordState.score?wordGameMessages.nearWin[Math.floor(Math.random()*wordGameMessages.nearWin.length)]:wordGameMessages.default[Math.floor(Math.random()*wordGameMessages.default.length)],t+=`<br><br>The word was: <strong>${wordState.targetWord}</strong>`),wordGameEls.feedback.innerHTML=t,wordGameEls.feedback.className="word-feedback "+(e?"feedback-correct":"feedback-wrong"),wordGameEls.wordDisplay.innerHTML=`
        <div class="word-display-info">${wordState.category} (${wordState.targetWord.length} letters)</div>
        <div class="word-display-letters">${wordState.targetWord.split("").join(" ")}</div>
    `,updateDifficultyDisplay(),wordState.targetWord="",wordState.category="",wordState.hint="",wordState.letterChoices=[],wordState.guessedLetters=[],wordState.revealedLetters=[],saveGameState(),updateGameUI()}function setupWordGameEvents(){wordGameEls.startBtn.addEventListener("click",startWordGame),wordGameEls.newWordBtn.addEventListener("click",startWordGame),wordGameEls.hintBtn.addEventListener("click",getHint),document.addEventListener("click",e=>{var t=e.target.closest(".letter-choice");t&&wordState.isPlaying?makeGuess(t.dataset.letter):(t=e.target.closest(".remove-letter"))&&wordState.isPlaying&&(e=parseInt(t.dataset.index),wordState.revealedLetters[e]||(wordState.guessedLetters[e]="",updateGameUI(),saveGameState()))})}async function initWordGame(){wordState.sessionUsedWords=JSON.parse(sessionStorage.getItem(SESSION_USED_WORDS_KEY))||[],wordState.usedWords=JSON.parse(localStorage.getItem("word-game-used-words"))||[],Object.assign(wordState,{targetWord:"",category:"",difficulty:"easy",attemptsLeft:difficultySettings.easy.maxAttempts,maxAttempts:difficultySettings.easy.maxAttempts,guesses:[],hintsUsed:0,maxHints:difficultySettings.easy.maxHints,revealedLetters:[],score:0,isDailyChallenge:!1,isPlaying:!1,letterChoices:[],currentLetterIndex:0,guessedLetters:[],winsAtCurrentDifficulty:JSON.parse(localStorage.getItem("word-game-wins"))?.[wordState.difficulty]||0,lastPlayed:(new Date).toISOString().split("T")[0]}),initializeGame(),setupWordGameEvents(),await startWordGame(),saveGameState()}export{initWordGame};
